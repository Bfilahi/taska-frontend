<mat-card appearance="outlined" class="min-h-[250px] min-w-fit flex-2 max-w-[400px]">
  <mat-card-header>
    <mat-icon fontIcon="chat_bubble"></mat-icon>
    <span class="ml-3 font-bold mb-7">Task Notes ({{ notes().length }})</span>
  </mat-card-header>
  <mat-card-content>
    <div class="notes-container flex flex-col gap-3 min-h-[300px] h-[300px] overflow-y-scroll">
      @for (note of notes(); track note.id) {
      <div
        class="note-container border rounded-md p-2 w-fit"
        [style.border-color]="'var(--mat-sys-secondary-container)'"
      >
        <div class="flex items-center gap-2">
          <div class="flex items-center gap-2">
            <div
              class="w-6 h-6 min-w-6 min-h-6 rounded-xl font-bold grid place-items-center"
              [style.background]="'var(--mat-extended-custom-color1-color)'"
              [style.color]="'var(--mat-sys-surface-container)'"
            >
              {{ userService.user()?.firstName?.[0] }}
            </div>
            <h4>{{ userService.user()?.lastName }}</h4>
          </div>
          <small class="subtext text-[12px]">â€¢ {{ note.createdAt }}</small>

          <button class="cursor-pointer" (click)="onDelete(note.id)">
            @if(!isDeleteLoading()){
            <mat-icon fontIcon="delete" class="!text-[16px] !h-fit !w-fit" [style.color]="'var(--mat-sys-error)'"></mat-icon>
            } @else {
            <mat-icon fontIcon="sync" class="!text-[16px] !h-fit !w-fit animate-spin"></mat-icon>
            }
          </button>
        </div>
        <p class="note mt-3" [style.color]="'var(--mat-sys-on-surface-variant)'">
          {{ note.note }}
        </p>
      </div>
      }
    </div>

    <div class="flex flex-wrap items-end gap-3 w-full p-2">
      <textarea
        matInput
        #notearea
        placeholder="Write a note..."
        class="flex-1 p-2 min-w-[50px] min-h-[50px] border rounded-md placeholder:text-[var(--mat-sys-on-surface-variant)]"
        [style.border-color]="'var(--mat-sys-secondary-container)'"
      ></textarea>
      <button matButton="filled" (click)="post(notearea)">
        Post @if(!isPostLoading()){
        <mat-icon fontIcon="add_circle"></mat-icon>
        } @else {
        <mat-icon fontIcon="sync" class="animate-spin"></mat-icon>
        }
      </button>
    </div>
  </mat-card-content>
</mat-card>
